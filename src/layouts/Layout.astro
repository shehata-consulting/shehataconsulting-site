---
// src/layouts/Layout.astro
// Base layout used by all pages.
// Handles <head>, fonts, global CSS, nav, footer, and cursor.

import { SITE } from "@/config";
import "../styles/global.css";

interface Props {
  title?: string;
  description?: string;
  ogImage?: string;
}

const {
  title = SITE.title,
  description = SITE.desc,
  ogImage = SITE.ogImage,
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, SITE.website);
const ogImageURL   = new URL(ogImage, SITE.website);
---

<!doctype html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={description} />

    <!-- Canonical -->
    <link rel="canonical" href={canonicalURL} />

    <!-- Open Graph -->
    <meta property="og:title"       content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url"         content={canonicalURL} />
    <meta property="og:image"       content={ogImageURL} />
    <meta property="og:type"        content="website" />

    <!-- Twitter Card -->
    <meta name="twitter:card"        content="summary_large_image" />
    <meta name="twitter:title"       content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image"       content={ogImageURL} />

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Outfit:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />

    <title>{title}</title>
  </head>

  <body>
    <!-- Custom cursor dot (hidden on touch devices via JS) -->
    <div class="cursor" id="cursor" aria-hidden="true"></div>

    <!-- ─── Navigation ─────────────────────────────── -->
    <nav class="site-nav" aria-label="Main navigation">
      <a href="/" class="nav-logo"><b>Shehata</b> Tech Solutions</a>

      <!-- Desktop links -->
      <div class="nav-links">
        <a href="/#services">Services</a>
        <a href="/#approach">Approach</a>
        <a href="/about">About</a>
        <a href="/#contact" class="nav-cta">Contact</a>
      </div>

      <!-- Mobile hamburger button -->
      <button class="nav-burger" id="nav-burger" aria-label="Open menu" aria-expanded="false">
        <span></span><span></span><span></span>
      </button>
    </nav>

    <!-- Mobile drawer -->
    <div class="nav-drawer" id="nav-drawer" aria-hidden="true">
      <a href="/#services" class="drawer-link">Services</a>
      <a href="/#approach" class="drawer-link">Approach</a>
      <a href="/about"     class="drawer-link">About</a>
      <a href="/#contact"  class="drawer-link drawer-cta">Contact</a>
    </div>

    <!-- ─── Page content ───────────────────────────── -->
    <main>
      <slot />
    </main>

    <!-- ─── Footer ─────────────────────────────────── -->
    <footer class="site-footer">
      <span class="footer-logo"><b>Shehata</b> Tech Solutions</span>
      <nav class="footer-nav" aria-label="Footer navigation">
        <a href="/#services">Services</a>
        <a href="/#approach">Approach</a>
        <a href="/about">About</a>
        <a href="mailto:contact@shehatatech.com">Contact</a>
      </nav>
      <span class="footer-copy">
        © {new Date().getFullYear()} Shehata Tech Solutions LLC
      </span>
    </footer>

    <!-- ─── Scripts ────────────────────────────────── -->
    <script>
      // Hide cursor on touch devices
      const cursor = document.getElementById("cursor");
      if (cursor && window.matchMedia("(pointer: coarse)").matches) {
        cursor.style.display = "none";
      }

      // Track mouse position
      document.addEventListener("mousemove", e => {
        if (!cursor) return;
        cursor.style.left = e.clientX + "px";
        cursor.style.top  = e.clientY + "px";
      });

      // Expand cursor on interactive elements
      document.querySelectorAll("a, button").forEach(el => {
        el.addEventListener("mouseenter", () => {
          if (!cursor) return;
          cursor.style.width   = "32px";
          cursor.style.height  = "32px";
          cursor.style.opacity = "0.25";
        });
        el.addEventListener("mouseleave", () => {
          if (!cursor) return;
          cursor.style.width   = "6px";
          cursor.style.height  = "6px";
          cursor.style.opacity = "1";
        });
      });

      // Hamburger menu toggle
      const burger = document.getElementById("nav-burger");
      const drawer = document.getElementById("nav-drawer");

      function openMenu() {
        burger?.classList.add("open");
        drawer?.classList.add("open");
        drawer?.setAttribute("aria-hidden", "false");
        burger?.setAttribute("aria-expanded", "true");
        burger?.setAttribute("aria-label", "Close menu");
        document.body.style.overflow = "hidden";
      }

      function closeMenu() {
        burger?.classList.remove("open");
        drawer?.classList.remove("open");
        drawer?.setAttribute("aria-hidden", "true");
        burger?.setAttribute("aria-expanded", "false");
        burger?.setAttribute("aria-label", "Open menu");
        document.body.style.overflow = "";
      }

      burger?.addEventListener("click", () => {
        burger.classList.contains("open") ? closeMenu() : openMenu();
      });

      // Close drawer when a link is clicked
      drawer?.querySelectorAll(".drawer-link").forEach(link => {
        link.addEventListener("click", closeMenu);
      });

      // Close on Escape key
      document.addEventListener("keydown", e => {
        if (e.key === "Escape") closeMenu();
      });

      // Scroll reveal
      const revealEls = document.querySelectorAll(".reveal");
      const observer  = new IntersectionObserver(
        entries => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add("visible");
              observer.unobserve(entry.target);
            }
          });
        },
        { threshold: 0.12 }
      );
      revealEls.forEach(el => observer.observe(el));
    </script>
  </body>
</html>